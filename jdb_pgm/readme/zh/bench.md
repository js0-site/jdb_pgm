## Pgm 索引评测

Pgm-Index 与二分查找在不同 epsilon 值下的性能对比。

| 算法        | Epsilon | 数据量 | 内存 (MB) | 吞吐量 (M/s) |
| --------- | ------- | --- | ------- | --------- |
| jdb_pgm   | 32      | 1M  | < 0.01  | 67.21     |
| jdb_pgm   | 32      | 1M  | < 0.01  | 65.16     |
| jdb_pgm   | 64      | 1M  | < 0.01  | 58.90     |
| jdb_pgm   | 64      | 1M  | < 0.01  | 57.08     |
| jdb_pgm   | 128     | 1M  | < 0.01  | 50.65     |
| jdb_pgm   | 128     | 1M  | < 0.01  | 49.77     |
| pgm_index | 32      | 1M  | 1.43    | 48.79     |
| pgm_index | 32      | 1M  | 1.43    | 47.12     |
| pgm_index | 64      | 1M  | 0.72    | 44.01     |
| pgm_index | 64      | 1M  | 0.72    | 43.37     |
| pgm_index | 128     | 1M  | 0.36    | 40.26     |
| 二分查找      | -       | 1M  | 0       | 40.11     |
| pgm_index | 128     | 1M  | 0.36    | 39.38     |
| BTreeMap  | -       | 1M  | 16.84   | 15.39     |

### 精度对比: jdb_pgm vs pgm_index

| 数据量 | Epsilon | jdb_pgm Max | jdb_pgm Avg | pgm_index Max | pgm_index Avg |
| --- | ------- | ----------- | ----------- | ------------- | ------------- |
| 1M  | 32      | 32          | 10.97       | 63            | 31.50         |
| 1M  | 64      | 64          | 21.87       | 128           | 63.50         |
| 1M  | 128     | 128         | 44.19       | 256           | 127.48        |

### 构建时间对比: jdb_pgm vs pgm_index

| 数据量 | 算法        | Epsilon | 耗时     |
| --- | --------- | ------- | ------ |
| 1M  | pgm_index | 32      | 1.40ms |
| 1M  | pgm_index | 64      | 1.28ms |
| 1M  | pgm_index | 128     | 1.24ms |
| 1M  | jdb_pgm   | 32      | 1.17ms |
| 1M  | jdb_pgm   | 64      | 1.19ms |
| 1M  | jdb_pgm   | 128     | 1.19ms |
### 评测配置查询次数: 1,000,000数据量集合: 1,000,000Epsilon 集合: 32, 64, 128
---

### Epsilon (ε) 说明

*Epsilon (ε) 控制精度与速度的权衡：*

*数学定义：ε 定义了预测位置与实际位置在数据数组中的最大绝对误差。调用 `load(data, epsilon, ...)` 时，ε 保证 |pred - actual| ≤ ε，其中位置是长度为 `data.len()` 的数据数组中的索引。*

*举例说明：对于 100 万个元素，ε=32 时，如果实际键在位置 1000：*
- ε=32 预测位置在 968-1032 之间，然后检查最多 64 个元素
- ε=128 预测位置在 872-1128 之间，然后检查最多 256 个元素

### 备注
#### 什么是 Pgm-Index?
Pgm-Index（分段几何模型索引）是一种学习型索引结构，使用分段线性模型近似键的分布。它提供 O(log ε) 的搜索时间，并保证误差边界，其中 ε 控制内存和速度之间的权衡。

#### 为什么与二分查找对比?
二分查找是已排序数组查找的基准。Pgm-Index 旨在：匹配或超过二分查找的性能，相比传统索引减少内存开销，为大数据集提供更好的缓存局部性。

#### 环境
- 系统: macOS (arm64)
- CPU: Apple M2 Max- 核心数: 12- 内存: 64GB
- Rust 版本: 1.85.0
#### 参考
- [Pgm-Index 论文](https://doi.org/10.1145/3373718.3394764)
- [Pgm-Index 官方网站](https://pgm.di.unipi.it/)
- [学习型索引](https://arxiv.org/abs/1712.01208)